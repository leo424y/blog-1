# 前端工程

大家下午好，我叫張雲龍，來自UC。我自己沒什麼介紹。（PPT的）這個角落是我的微博"[前端農民工](http://weibo.com/fouber)"。

![](assets/01.jpg)

我從入行到現在比較多的時間是專注於做前端工程方面的學習和探索，我覺得前端是一個技術問題比較少，工程問題比較多的研發領域，它很特殊。我過去一年多的時間一直準備想跟大家系統的闡述，向業界系統的闡述一下前端工程總得問題。今天算是一個簡單的開始，先跟大家聊一聊這個話題。

-------------------------

![](assets/02.jpg)

在前端技術面試中有一道經典的面試題“[從輸入URL到頁面載入完的過程中都發生了什麼事情？](http://igoro.com/archive/what-really-happens-when-you-navigate-to-a-url/)”這個問題既考深度又考廣度，可以一定程度上體現前端技術工程師的技術水平。

-------------------------

![](assets/03.jpg)

而我想講這樣一個問題：“從準備寫第一行程式碼到項目釋出上線的過程中都發生了什麼事情？”，這是對應到前端工程領域的經典問題。

-------------------------

![](assets/04.jpg)

首先，我要向大家闡述一個基本的觀念：前端是一種特殊的GUI軟體。這裡是傳統客戶端的軟體，客戶端軟體會把原程式碼打包變成安裝包，分發給使用者，使用者安裝它，所有程式資源都在客戶端本地，前端應用基本與之類似，所以前端本質上講是一種GUI軟體。但是前端在工程上又有點特殊，使得我們不能完全按照客戶端GUI軟體方法進行工程開發。

-------------------------

![](assets/05.jpg)

第一個特殊性，它是由三種語言組成，不像傳統的GUI軟體，前端由三種風格特別不同的程式語言組成，這三種缺一不可，我沒有辦法完全用JS構建一個應用，而脫離HTML和CSS。

-------------------------

![](assets/06.jpg)

第二個特殊性是，前端是一種遠端部署，執行時增量安裝的軟體。不像傳統的GUI軟體把所有資源都放在客戶端執行時只需載入資料，我們要把程式資源都放在服務端，由使用者在執行時安裝。這兩個特殊性最終導致了前端工程跟傳統GUI工程的不同。後面我會詳細闡述這兩點特殊性對前端工程的影響。

-------------------------

![](assets/07.jpg)

說了這麼多，先來定義一下什麼是前端工程？前端工程是一門研究用工程化方法構建和維護有效的、實用的和高質量的前端應用的學科。這個概念類比了軟體工程的定義，將其限定在了前端範圍。

-------------------------

![](assets/08.jpg)

大家可能會有一個疑問，本來一個記事本、瀏覽器就可以進行前端開發，這麼簡單的事情有必要搞的這麼複雜嗎？

-------------------------

![](assets/09.jpg)

2010年的時候Velocipy China大會上來自Facebook的David博士分享了一些 [資料](http://velocity.oreilly.com.cn/2010/index.php?func=session&name=%E9%9D%99%E6%80%81%E7%BD%91%E9%A1%B5%E8%B5%84%E6%BA%90%E7%9A%84%E7%AE%A1%E7%90%86%E5%92%8C%E4%BC%98%E5%8C%96) 。Facebook五年前，整站有10000多個靜態資源，還要被翻譯成超過100種語言版本。每種資源又會針對瀏覽器生成三種不同的版本，要針對不同頻寬的使用者做5種不同的打包方法，為了加快訪問速度。有3、4個不同的使用者組，下發不同的功能，用於小批次體驗新的產品功能。靜態資源的壓縮和被壓縮有不同的狀態切換，我們可以線上上，使用者有問題了我就他發一個連結，連結開啟之後就是沒有壓縮的動態資源，用於定位和偵錯。在5年前，Facebook正個網站各種頁面狀態的資源組合情況就有300萬種，這就是巨大的工程化問題。

-------------------------

![](assets/10.jpg)

有人問我前端到後面學什麼？我感覺前端在初期的時候學了頁面開發，可能還有很多東西要接觸。我總結前端工程涉及八個比較大的分類：

* 組織架構：前端開發規範和架構設計，包括模組化/元件化開發模型、開發框架、目錄規範、組織形式等。
* 工程部署：有關前端項目的部署方式，比如靜態資源部署，CDN快取接入，模板部署等。
* 效能優化：網站效能優化的工程化方法，比如按需載入、打包合併、資源快取等
* 工具平臺：構建工具與開發平臺
* 開發流程：前端開發流程，包括開發、測試、部署等環節的打通
* 統計監控：使用者行為與網站狀態監控，比如pv/uv、訪問路徑、使用者資訊、網站效能等
* 前端安全：前端安全防範的工程化方法，比如xss、csrf等
* 系統測試：前端系統測試的工程化方法

-------------------------

![](assets/11.jpg)

以上工程問題在傳統GUI軟體中也有涉及，然而，前端的特殊性使其在每項工程問題上都有著有別於傳統GUI軟體獨特的解決方式。我們非常有必要針對前端工程化進行系統的探索和研究。今天主要跟大家分享的就是前端特殊性對於開發相關的工程問題的影響。

-------------------------

![](assets/12.jpg)

我曾經在知乎上回答過一個問題：“[大公司裡怎樣開發和部署前端程式碼？](http://www.zhihu.com/question/20790576/answer/32602154)”有興趣的同學可以看一下原文，這裡做一點“提純”：

-------------------------

![](assets/13.jpg)

我們從一個簡單的頁面說起：我們要寫一個頁面，裡面用到一個a.css資源，把它們丟到伺服器上，我們的網頁就能訪問了，非常簡單。但是有個問題，如果我們不對a.css檔案做快取的話，每次訪問頁面都要載入這個資源，這顯然是浪費。

-------------------------

![](assets/14.jpg)

我們知道瀏覽器快取可以解決這個問題。有兩類瀏覽器快取：協商快取和本地快取。協商快取指，每次向伺服器發器查詢請求，伺服器會告訴我們這個檔案有沒有修改，如果沒有修改，瀏覽器就可以用本地。協商快取每次都要跟伺服器確認快取是否更新，建立連線也會有時間成本。這時候就會想到使用本地快取，伺服器在傳送資源的時候告訴瀏覽器在一定時間內不要來伺服器詢問，直接使用本地的快取就可以了。這種快取方式是大公司最希望得到的效果，始終讓使用者直接使用本地快取。

-------------------------

![](assets/15.jpg)

-------------------------

![](assets/16.jpg)

-------------------------

![](assets/17.jpg)

-------------------------

![](assets/18.jpg)

-------------------------

![](assets/19.jpg)

-------------------------

![](assets/20.jpg)

-------------------------

![](assets/21.jpg)

-------------------------

![](assets/22.jpg)

-------------------------

![](assets/23.jpg)

-------------------------

![](assets/24.jpg)

-------------------------

![](assets/25.jpg)

-------------------------

![](assets/26.jpg)

-------------------------

![](assets/27.jpg)

-------------------------

![](assets/28.jpg)

-------------------------

![](assets/29.jpg)

-------------------------

![](assets/30.jpg)

-------------------------

![](assets/31.jpg)

-------------------------

![](assets/32.jpg)

-------------------------

![](assets/33.jpg)

-------------------------

![](assets/34.jpg)

-------------------------

![](assets/35.jpg)

-------------------------

![](assets/36.jpg)

-------------------------

![](assets/37.jpg)

-------------------------

![](assets/38.jpg)

-------------------------

![](assets/39.jpg)

-------------------------

![](assets/40.jpg)

-------------------------

![](assets/41.jpg)

-------------------------

![](assets/42.jpg)

-------------------------

![](assets/43.jpg)

-------------------------

![](assets/44.jpg)

-------------------------

![](assets/45.jpg)

-------------------------

![](assets/46.jpg)

-------------------------

![](assets/47.jpg)

-------------------------

![](assets/48.jpg)

-------------------------

![](assets/49.jpg)

-------------------------

![](assets/50.jpg)

-------------------------

![](assets/51.jpg)

-------------------------

![](assets/52.jpg)

-------------------------

![](assets/53.jpg)

-------------------------
